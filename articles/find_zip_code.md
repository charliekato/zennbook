---
title: "ÈÉµ‰æøÁï™Âè∑Ê§úÁ¥¢„ÉÑ„Éº„É´„Çíc#„Åß‰Ωú„Å£„Å¶„Åø„Åü"
emoji: "üò∏"
type: "idea" # tech: ÊäÄË°ìË®ò‰∫ã / idea: „Ç¢„Ç§„Éá„Ç¢
topics: [csharp, ADO]
published: true
---
# „ÅØ„Åò„ÇÅ„Å´
ÈÉµ‰æøÁï™Âè∑Ê§úÁ¥¢„Çµ„Ç§„Éà„Çí‰Ωú„Å£„Å¶„Åø„Åü„ÅÆ„Åß„Åô„Åå„Ç™„Éï„É©„Ç§„É≥„Åß„ÇÇÂãï„Åè„Éá„Çπ„ÇØ„Éà„ÉÉ„Éó„Ç¢„Éó„É™„Çí‰Ωú„Å£„Å¶„Åø„Åü„Åè„Å™„Å£„Åü„ÅÆ„ÅßVisual Studio„Çí‰Ωø„ÅÑC#„Åß„Éó„É≠„Ç∞„É©„É†„Çí‰Ωú„Å£„Å¶„Åø„Åæ„Åó„Åü„ÄÇVisual Studio„Åß‰Ωú„Çã„Å®„ÇΩ„Éº„Çπ„Éï„Ç°„Ç§„É´„Åå„ÅÑ„Åè„Å§„Å´„ÇÇÂàÜ„Åã„Çå„Çã„ÅÆ„ÅßÊâã‰ΩúÊ•≠„Åß‰∏Ä„Å§„Å´„Åæ„Å®„ÇÅ„Å¶ csc „Åß„Ç≥„É≥„Éë„Ç§„É´„Åß„Åç„Çã„Çà„ÅÜ„Å´„Åó„Åæ„Åó„Åü„ÄÇ„Å™„ÅÆ„Åß„ÇΩ„Éº„Çπ„Åã„Çâ„Ç≥„É≥„Éë„Ç§„É´„Åó„Åü„ÅÑÊñπ„ÅØ csc „Åß„Åß„Åç„Åæ„Åô„ÄÇ„Éá„Éº„Çø„Éô„Éº„Çπ„ÅØ„Ç®„ÇØ„Çª„É´„Åß„Åô„ÄÇ„Ç®„ÇØ„Çª„É´„ÇÇ„Åì„Åì„Åã„Çâ„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Åß„Åç„Åæ„Åô„Åå„ÄÅËá™ÂàÜ„Åß„ÇÇ‰Ωú„Çå„Çã„Çà„ÅÜ„Å´„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ
„Ç®„ÇØ„Çª„É´„Éï„Ç°„Ç§„É´„ÅØÂøÖË¶Å„Åß„Åô„Åå„ÄÅMicrosoft„ÅÆ„Ç®„ÇØ„Çª„É´„Ç¢„Éó„É™„Åå„Å™„Åè„Å¶„ÇÇ„Éó„É≠„Ç∞„É©„É†„ÅØÂãï„Åè„Å®ÊÄù„ÅÑ„Åæ„Åô„ÄÇ
![](/images/findZipCode/findZipCodeScreenShot.jpg =600x)
*„Çπ„ÇØ„É™„Éº„É≥„Ç∑„Éß„ÉÉ„Éà*
# „Éá„Éº„Çø„Éô„Éº„Çπ‰ΩúÊàê
## ÈÉµ‰æøÁï™Âè∑csv„ÅÆ„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ
„Éá„Éº„Çø„Éô„Éº„Çπ„Å´„ÅØaccess, sqlserver„ÇÑ„ÄÅmysql„Å™„Å©„ÅÇ„Çä„Åæ„Åô„Åå„ÄÅ„Ç®„ÇØ„Çª„É´„Å™„Çâ„Åü„ÅÑ„Å¶„ÅÑ„ÅÆÊñπ„ÅåÊåÅ„Å£„Å¶„ÅÑ„Çã„ÅÆ„Åß„Ç®„ÇØ„Çª„É´„Å´„Åó„Åæ„Åó„Åü„ÄÇ„Ç®„ÇØ„Çª„É´„Å™„ÇâÊØîËºÉÁöÑÁ∞°Âçò„Å´„Éá„Éº„Çø„Éô„Éº„Çπ„Çí‰Ωú„Çå„Çã„Å®ÊÄù„ÅÑ„Åæ„Åô„ÄÇ„Éá„Éº„Çø„Éô„Éº„Çπ„Çí‰Ωú„Çã„ÅÆ„ÇÇÈù¢ÂÄí„ÇÇ„Åó„Åè„ÅØ„ÄÅ„Ç®„ÇØ„Çª„É´„Ç¢„Éó„É™„Åù„ÅÆ„ÇÇ„ÅÆ„Çí„ÅäÊåÅ„Å°„Åß„Å™„ÅÑÊñπ„ÅØ[„Åì„Å°„Çâ„ÅÆgithub](https://github.com/charliekato/zennbook/tree/main/articles/findZipCode/zipcode.xlsx)„Åã„Çâ„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Åó„Å¶„Åä‰Ωø„ÅÑ„Åè„Å†„Åï„ÅÑ„ÄÇ
„Éá„Éº„Çø„ÅØÈÉµ‰æøÂ±Ä„ÅÆ„Éõ„Éº„É†„Éö„Éº„Ç∏„Åã„Çâutf_ken_all.csv „Çí„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Åó„Å¶„Åç„Åæ„Åô„ÄÇ„ÄåÈÉµ‰æøÁï™Âè∑„Éá„Éº„Çø„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Äç„Åß„Ç∞„Ç∞„Å£„Å¶„ÇÇ„Çâ„Åà„Å∞„Åô„Åê„Å´Âá∫„Å¶„Åè„Çã„ÅØ„Åö„Åß„Åô„ÄÇ‰ΩèÊâÄ„ÅÆÈÉµ‰æøÁï™Âè∑Ôºà1„É¨„Ç≥„Éº„Éâ1Ë°å„ÄÅUTF-8ÂΩ¢ÂºèÔºâÔºàCSVÂΩ¢ÂºèÔºâ„ÅÆ„Å®„Åì„Çç„Çí„ÇØ„É™„ÉÉ„ÇØ„Åó„Å¶zipÂΩ¢Âºè„ÅÆ„Éï„Ç°„Ç§„É´„Çí„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Åó„Åæ„Åô„ÄÇ
„Éï„Ç°„Ç§„É´„ÅØUTF-8„Å™„ÅÆ„Åßsjis„Å´Â§âÊèõ„Åô„ÇãÂøÖË¶Å„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇwindows„Åßutf-8„Çísjis„Å´Â§âÊèõ„Åô„ÇãÊñπÊ≥ï„ÅØChatGPT„Å´ËÅû„ÅÑ„Å¶„Åø„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ‰ª•‰∏ã„ÅØÁßÅ„ÅåËÅû„ÅÑ„ÅüÁµêÊûú„Åß„Åô„ÄÇ(Ê≥®ÊÑè: ÁßÅËá™Ë∫´„ÅØ„Åì„ÅÆÊñπÊ≥ï„Åß„ÅØ„ÇÑ„Å£„Å¶„ÅÑ„Åæ„Åõ„Çì„ÅÆ„Åß)
## UTF-8„Çísjis„Å´Â§âÊèõ
Windows„ÅßUTF-8„ÅÆ„ÉÜ„Ç≠„Çπ„Éà„Éï„Ç°„Ç§„É´„ÇíShift_JISÔºàsjisÔºâ„Å´Â§âÊèõ„Åô„Çã„Å´„ÅØ„ÄÅ„ÅÑ„Åè„Å§„Åã„ÅÆÊñπÊ≥ï„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ‰ª•‰∏ã„Å´„ÅÑ„Åè„Å§„Åã„ÅÆÊñπÊ≥ï„ÇíÁ§∫„Åó„Åæ„Åô„ÄÇ

1. PowerShell„Çí‰ΩøÁî®„Åô„ÇãÊñπÊ≥ï
PowerShell„Çí‰ΩøÁî®„Åó„Å¶„Éï„Ç°„Ç§„É´„ÇíÂ§âÊèõ„Åô„Çã„Åì„Å®„Åå„Åß„Åç„Åæ„Åô„ÄÇ‰ª•‰∏ã„ÅØ„Åù„ÅÆ‰∏Ä‰æã„Åß„Åô„ÄÇ

```powershell
# „Éï„Ç°„Ç§„É´„ÅÆÂÜÖÂÆπ„ÇíË™≠„ÅøÂèñ„Çä„ÄÅShift_JIS„Å´Â§âÊèõ„Åó„Å¶Êñ∞„Åó„ÅÑ„Éï„Ç°„Ç§„É´„Å´‰øùÂ≠ò„Åó„Åæ„Åô„ÄÇ
Get-Content -Path "C:\path\to\your\utf8file.txt" -Encoding UTF8 | Out-File -FilePath "C:\path\to\your\sjisfile.txt" -Encoding SJIS
```
2. „Ç≥„Éû„É≥„Éâ„Éó„É≠„É≥„Éó„Éà„Å®iconv„Çí‰ΩøÁî®„Åô„ÇãÊñπÊ≥ï
iconv„ÅØ„ÉÜ„Ç≠„Çπ„Éà„ÅÆ„Ç®„É≥„Ç≥„Éº„Éá„Ç£„É≥„Ç∞Â§âÊèõ„ÇíË°å„ÅÜ„É¶„Éº„ÉÜ„Ç£„É™„ÉÜ„Ç£„Åß„Åô„ÄÇWindows„Åßiconv„Çí‰ΩøÁî®„Åô„Çã„Å´„ÅØ„ÄÅÂ§ö„Åè„ÅÆÂ†¥Âêà„ÄÅCygwin„ÇÑMinGW„ÄÅWindows Subsystem for LinuxÔºàWSLÔºâ„Å™„Å©„ÅÆ„ÉÑ„Éº„É´„Çí„Ç§„É≥„Çπ„Éà„Éº„É´„Åô„ÇãÂøÖË¶Å„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ

‰æã„Åà„Å∞„ÄÅCygwin„Åå„Ç§„É≥„Çπ„Éà„Éº„É´„Åï„Çå„Å¶„ÅÑ„ÇãÂ†¥Âêà„ÄÅ‰ª•‰∏ã„ÅÆ„Çà„ÅÜ„Å´„Åó„Å¶UTF-8„Åã„ÇâShift_JIS„Å´Â§âÊèõ„Åß„Åç„Åæ„ÅôÔºö

```bash
iconv -f UTF-8 -t SHIFT_JIS "C:\path\to\your\utf8file.txt" > "C:\path\to\your\sjisfile.txt"
```
3. „Ç®„Éá„Ç£„Çø„Çí‰ΩøÁî®„Åô„ÇãÊñπÊ≥ï
Â§ö„Åè„ÅÆ„ÉÜ„Ç≠„Çπ„Éà„Ç®„Éá„Ç£„ÇøÔºà‰æãÔºöNotepad++„ÄÅVisual Studio Code„Å™„Å©Ôºâ„ÅØ„ÄÅ„Éï„Ç°„Ç§„É´„ÅÆ„Ç®„É≥„Ç≥„Éº„Éá„Ç£„É≥„Ç∞„ÇíÂ§âÊõ¥„Åô„ÇãÊ©üËÉΩ„ÇíÊèê‰æõ„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ„Ç®„Éá„Ç£„Çø„ÇíÈñã„Åç„ÄÅ„Éï„Ç°„Ç§„É´„ÇíShift_JIS„Ç®„É≥„Ç≥„Éº„Éá„Ç£„É≥„Ç∞„Åß‰øùÂ≠ò„Åô„Çã„Ç™„Éó„Ç∑„Éß„É≥„ÇíÈÅ∏Êäû„Åô„Çã„Åì„Å®„ÅßÂ§âÊèõ„Åß„Åç„Åæ„Åô„ÄÇ

„Åì„ÅÆÊñπÊ≥ï„ÅÆÂÖ∑‰ΩìÁöÑ„Å™ÊâãÈ†Ü„ÅØ„ÄÅ‰ΩøÁî®„Åó„Å¶„ÅÑ„Çã„Ç®„Éá„Ç£„Çø„Å´„Çà„Å£„Å¶Áï∞„Å™„Çä„Åæ„Åô„ÅÆ„Åß„ÄÅ„Ç®„Éá„Ç£„Çø„ÅÆÂÖ¨Âºè„Éâ„Ç≠„É•„É°„É≥„Éà„ÇÑ„Éò„É´„Éó„ÇíÂèÇÁÖß„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ

„Åì„Çå„Çâ„ÅÆÊñπÊ≥ï„ÅÆ‰∏≠„Åã„Çâ„ÄÅÁä∂Ê≥Å„ÇÑÂ•Ω„Åø„Å´Âøú„Åò„Å¶ÊúÄÈÅ©„Å™ÊñπÊ≥ï„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ

## „Ç®„ÇØ„Çª„É´„Å´Âèñ„ÇäËæº„Åø
„Ç®„ÇØ„Çª„É´„Å´Âèñ„ÇäËæº„ÇÄ„ÅÆ„ÅØÂ§âÊèõ„Åó„Å¶„Åß„Åç„Å¶„Åücsv „Çí„ÉÄ„Éñ„É´„ÇØ„É™„ÉÉ„ÇØ„Åô„Çå„Å∞„Åß„Åç„Åæ„Åô„ÄÇ„Ç∑„Éº„Éà„ÅÆÂêçÂâç„ÅØzipcode„Å´„Åó„Å¶„Åä„ÅÑ„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ‰∏çÂøÖË¶Å„Å™„Ç´„É©„É†„ÅØ„Åô„Åπ„Å¶ÂâäÈô§„Åó„ÄÅ7Ê°Å„ÅÆÈÉµ‰æøÁï™Âè∑„Å®ÁúåÂêç„ÄÅÈÉΩÂ∏ÇÂêç„ÄÅÁî∫Âêç„ÅÆ4„Å§„ÅÆ„Ç´„É©„É†„Å†„Åë„ÅÆ„Åì„Åó„ÄÅÂÖàÈ†≠Ë°å„Å´Ë¶ãÂá∫„Åó(„Éò„ÉÉ„ÉÄ„Éº)„ÇíÊåøÂÖ•„Åó„Åæ„Åô„ÄÇ
![](/images/findZipCode/zipcodexlsx.jpg =360x)
‰∏ä„ÅÆÂõ≥„ÅÆ„Çà„ÅÜ„Å´7Ê°Å„ÅÆÈÉµ‰æøÁï™Âè∑„ÅØ zipcode ÁúåÂêç„ÅØ pref ÈÉΩÂ∏ÇÂêç„ÅØ city Áî∫Âêç„ÅØ street„Å´„Åó„Åæ„Åô„ÄÇ
„Ç®„ÇØ„Çª„É´„Å´„ÅØ„ÇÇ„ÅÜ‰∏ÄÊûö„Ç∑„Éº„Éà„Çí‰Ωú„Çä„Åæ„Åô„ÄÇ„Åì„ÅÆ„Ç∑„Éº„Éà„Å´„ÅØÁúåÂêç„Å®ÁúåÁï™Âè∑„ÅÆÂØæÂøúË°®„Çí‰Ωú„Çä„Åæ„Åô„ÄÇ„Åì„Çå„ÇÇ„ÄåÁúåÁï™Âè∑„Äç„Åß„Ç∞„Ç∞„Å£„Åü„ÇâÂá∫„Å¶„Åç„Åæ„Åô„ÅÆ„Åß„Åù„Çå„Çí‰Ωø„Å£„Å¶‰∏ã„ÅÆÂõ≥„ÅÆ„Çà„ÅÜ„Å´‰Ωú„Çä„Åæ„Åô„ÄÇË¶ãÂá∫„ÅóË°å„ÅØÁúåÂêç„Çí pref ÁúåÁï™Âè∑„Çí„ÄÄprefNo„ÄÄ„Å®„Åó„Å¶„Åä„ÅÑ„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ
![](/images/findZipCode/prefNo.jpg =360x)
Âá∫Êù•„Åüexcel„Éï„Ç°„Ç§„É´„ÅØzipcode.xlsx„Å®„ÅÑ„ÅÜÂêçÂâç„ÅßÂÆüË°å„Éï„Ç°„Ç§„É´(findZipCode.exe)„Å®„Åä„Å™„Åò„Éï„Ç©„É´„ÉÄ„Éº„Å´ÂÖ•„Çå„Å¶„Åä„ÅèÂøÖË¶Å„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ
# „Éó„É≠„Ç∞„É©„É†Êú¨‰Ωì
„Éá„Éº„Çø„Éô„Éº„Çπ„Åå„Åß„Åç„Åü„ÅÆ„Åß„Éó„É≠„Ç∞„É©„É†„Åß„Åô„ÄÇ„Éó„É≠„Ç∞„É©„É†„ÅØvisual studio„Åß‰Ωú„Çä„Åæ„Åó„Åü„Åå„ÄÅvisual studio„Åã„Çâ„Éó„É≠„Ç∞„É©„É†„ÅÆ„É™„É™„Éº„Çπ„Çí„Å©„ÅÜ„ÇÑ„Çã„ÅÆ„Åã„Çè„Åã„Çâ„ÅÑ„ÅÆ„Åß(„Åô„ÅÑ„Åæ„Åõ„Çì„ÄÇ)„Åß„Åç„Åü„ÇΩ„Éº„Çπ„Ç≥„Éº„Éâ„Çí‰∏Ä„Å§„ÅÆ„Éï„Ç°„Ç§„É´„Å´„Åæ„Å®„ÇÅ„Åæ„Åó„Åü„ÄÇ[„Åì„Åì](https://github.com/charliekato/zennbook/tree/main/articles/findZipCode/findZipCode.cs)„Åã„Çâ„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Åß„Åç„Åæ„Åô„ÄÇ‰ª•‰∏ã„Å´„ÇÇ„Ç≥„Éº„Éâ„ÇíËºâ„Åõ„Åæ„Åô„ÄÇ„Éó„É≠„Ç∞„É©„É†„ÅÆË™¨Êòé„ÅØÂâ≤ÊÑõ„Åï„Åõ„Å¶„ÅÑ„Åü„Å†„Åç„Åæ„Åô„ÄÇcsc „Åß„Ç≥„É≥„Éë„Ç§„É´„Åß„Åç„Åæ„Åô„Åå„ÄÅÂÆüË°å„Éï„Ç°„Ç§„É´„ÅåÂøÖË¶Å„Å™Êñπ„ÅØ[„Åì„Å°„Çâ](https://github.com/charliekato/zennbook/tree/main/articles/findZipCode/findZipCode.exe)„Åã„Çâ„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ
```c#

using System;
using System.Collections.Generic;
using System.Linq;
using System.Threading.Tasks;
using System.IO;
using System.Windows.Forms;
using System.Data.OleDb;

namespace findZipCode
{
    public partial class Form1 : Form
    {
        private const string magicWord = "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=";
        private const string magicTail = ";Extended Properties='Excel 12.0; HDR=Yes'";
        public string excelFile;
        public string city;
        public string pref;
        public string street;
         public Form1()
        {
            InitializeComponent();
            excelFile = get_excel_file("findZipCode.ini");
            get_pref_list();
            myinit();
        }
        private string get_excel_file(string filename)
        {
            string excelFileName = null;
            try
            {
                if (File.Exists(filename))
                {
                    string[] lines = File.ReadAllLines(filename);
                    foreach (var line in lines)
                    {
                        // Ë°å„Åå # „ÅßÂßã„Åæ„Å£„Å¶„ÅÑ„Å™„ÅÑ„ÅãÁ¢∫Ë™ç
                        if (!line.StartsWith("#"))
                        {
                            // EXCELFILE> „ÅåÂê´„Åæ„Çå„Å¶„ÅÑ„ÇãË°å„ÇíÊé¢„Åô
                            if (line.StartsWith("EXCELFILE>"))
                            {
                                // ÊñáÂ≠óÂàó„Åã„Çâ‰∏çË¶Å„Å™ÈÉ®ÂàÜ„ÇíÈô§Âéª„Åó„Å¶„ÄÅexcelFileName „Å´Ââ≤„ÇäÂΩì„Å¶„Çã
                                excelFileName = line.Replace("EXCELFILE>", "").Trim();
                                break;  // Ë¶ã„Å§„Åë„Åü„Çâ„É´„Éº„Éó„ÇíÁµÇ‰∫Ü
                            }
                        }
                    }
                    if (string.IsNullOrEmpty(excelFileName))
                    {
                        MessageBox.Show("Error !! content of your " + filename + " is invalid. ");

                    }
                }

            } catch {
                MessageBox.Show("Error!!");
            }
            return excelFileName;

        }
        private void myinit()
        {
            lbxCity.SelectionMode = SelectionMode.One;
            lbxPref.SelectionMode = SelectionMode.One;
            lbxStreet.SelectionMode = SelectionMode.One;
            lblPostalCode.Text = string.Empty;
            this.Width = 800;
        }
        public void get_pref_list()
        {
            String connectionString = magicWord + excelFile + magicTail;
            using (OleDbConnection conn = new OleDbConnection(connectionString))
            {
                string query = "SELECT prefNo, pref from [pref$] order by prefNo;";
                OleDbCommand comm = new OleDbCommand(query, conn);
                conn.Open();
                using (var dr = comm.ExecuteReader())
                {
                    while (dr.Read())
                    {
                        this.lbxPref.Items.Add(Convert.ToString(dr["pref"]));
                    }
                }
            }
        }

        private void lbxPref_SelectedIndexChanged(object sender, EventArgs e)
        {
            String connectionString = magicWord + excelFile + magicTail;
            this.lbxCity.Items.Clear();
            pref = Convert.ToString(lbxPref.SelectedItem);
            using (OleDbConnection conn = new OleDbConnection(connectionString))
            {
                string query = "SELECT DISTINCT city from [zipcode$] where pref = \"" + pref + "\";";
                OleDbCommand comm = new OleDbCommand(query, conn);
                conn.Open();
                using (var dr = comm.ExecuteReader())
                {
                    while (dr.Read())
                    {
                        this.lbxCity.Items.Add(Convert.ToString(dr["city"]));
                    }
                }
            }
        }



        private void lbxCity_SelectedIndexChanged(object sender, EventArgs e)
        {
            String connectionString = magicWord + excelFile + magicTail;
            const string others = "‰ª•‰∏ã„Å´Êé≤Ëºâ„Åå„Å™„ÅÑÂ†¥Âêà";
            this.lbxStreet.Items.Clear();
            city = Convert.ToString(lbxCity.SelectedItem);
            this.lbxStreet.Items.Add(others);
            using (OleDbConnection conn = new OleDbConnection(connectionString))
            {
                string query = "SELECT DISTINCT street from [zipcode$] where pref = \""+
                    pref + "\" AND city = \"" + city + "\";";
                OleDbCommand comm = new OleDbCommand(query, conn);
                conn.Open();
                using (var dr = comm.ExecuteReader())
                {
                    while (dr.Read())
                    {
                        street = Convert.ToString(dr["street"]);
                        if (street != others)
                        this.lbxStreet.Items.Add(street);
                    }
                }
            }

        }

        private void lbxStreet_SelectedIndexChanged(object sender, EventArgs e)
        {
            String connectionString = magicWord + excelFile + magicTail;
            street = Convert.ToString(lbxStreet.SelectedItem);
            using (OleDbConnection conn = new OleDbConnection(connectionString))
            {
                string query = "SELECT zipcode from [zipcode$] where pref = \"" + 
                    pref+ "\" AND city = \"" + city + 
                    "\" AND street = \"" + street + "\";";
                OleDbCommand comm = new OleDbCommand(query, conn);
                conn.Open();
                using (var dr = comm.ExecuteReader())
                {
                    while (dr.Read())
                    {
                        string postalNumber = Convert.ToString(dr["zipcode"]);
                        string postalCode = postalNumber.Insert(3, "-");
                        this.lblPostalCode.Text = pref+city+street+ "„ÅÆÈÉµ‰æøÁï™Âè∑„ÅØ " + postalCode;
                    }
                }
            }
        }

    }
    partial class Form1
    {
        /// <summary>
        /// ÂøÖË¶Å„Å™„Éá„Ç∂„Ç§„Éä„ÉºÂ§âÊï∞„Åß„Åô„ÄÇ
        /// </summary>
        private System.ComponentModel.IContainer components = null;

        /// <summary>
        /// ‰ΩøÁî®‰∏≠„ÅÆ„É™„ÇΩ„Éº„Çπ„Çí„Åô„Åπ„Å¶„ÇØ„É™„Éº„É≥„Ç¢„ÉÉ„Éó„Åó„Åæ„Åô„ÄÇ
        /// </summary>
        /// <param name="disposing">„Éû„Éç„Éº„Ç∏„Éâ „É™„ÇΩ„Éº„Çπ„ÇíÁ†¥Ê£Ñ„Åô„ÇãÂ†¥Âêà„ÅØ true „ÇíÊåáÂÆö„Åó„ÄÅ„Åù„ÅÆ‰ªñ„ÅÆÂ†¥Âêà„ÅØ false „ÇíÊåáÂÆö„Åó„Åæ„Åô„ÄÇ</param>
        protected override void Dispose(bool disposing)
        {
            if (disposing && (components != null))
            {
                components.Dispose();
            }
            base.Dispose(disposing);
        }

        #region Windows „Éï„Ç©„Éº„É† „Éá„Ç∂„Ç§„Éä„Éº„ÅßÁîüÊàê„Åï„Çå„Åü„Ç≥„Éº„Éâ

        /// <summary>
        /// „Éá„Ç∂„Ç§„Éä„Éº „Çµ„Éù„Éº„Éà„Å´ÂøÖË¶Å„Å™„É°„ÇΩ„ÉÉ„Éâ„Åß„Åô„ÄÇ„Åì„ÅÆ„É°„ÇΩ„ÉÉ„Éâ„ÅÆÂÜÖÂÆπ„Çí
        /// „Ç≥„Éº„Éâ „Ç®„Éá„Ç£„Çø„Éº„ÅßÂ§âÊõ¥„Åó„Å™„ÅÑ„Åß„Åè„Å†„Åï„ÅÑ„ÄÇ
        /// </summary>
        private void InitializeComponent()
        {
            this.lbxPref = new System.Windows.Forms.ListBox();
            this.lbxCity = new System.Windows.Forms.ListBox();
            this.lbxStreet = new System.Windows.Forms.ListBox();
            this.lblPref = new System.Windows.Forms.Label();
            this.lblCity = new System.Windows.Forms.Label();
            this.lblStreet = new System.Windows.Forms.Label();
            this.lblPostalCode = new System.Windows.Forms.Label();
            this.SuspendLayout();
            // 
            // lbxPref
            // 
            this.lbxPref.Font = new System.Drawing.Font("MS UI Gothic", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(128)));
            this.lbxPref.FormattingEnabled = true;
            this.lbxPref.ItemHeight = 33;
            this.lbxPref.Location = new System.Drawing.Point(133, 40);
            this.lbxPref.Name = "lbxPref";
            this.lbxPref.Size = new System.Drawing.Size(207, 763);
            this.lbxPref.TabIndex = 0;
            this.lbxPref.SelectedIndexChanged += new System.EventHandler(this.lbxPref_SelectedIndexChanged);
            // 
            // lbxCity
            // 
            this.lbxCity.Font = new System.Drawing.Font("MS UI Gothic", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(128)));
            this.lbxCity.FormattingEnabled = true;
            this.lbxCity.ItemHeight = 33;
            this.lbxCity.Location = new System.Drawing.Point(454, 40);
            this.lbxCity.Name = "lbxCity";
            this.lbxCity.Size = new System.Drawing.Size(302, 763);
            this.lbxCity.TabIndex = 1;
            this.lbxCity.SelectedIndexChanged += new System.EventHandler(this.lbxCity_SelectedIndexChanged);
            // 
            // lbxStreet
            // 
            this.lbxStreet.Font = new System.Drawing.Font("MS UI Gothic", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(128)));
            this.lbxStreet.FormattingEnabled = true;
            this.lbxStreet.ItemHeight = 33;
            this.lbxStreet.Location = new System.Drawing.Point(874, 40);
            this.lbxStreet.Name = "lbxStreet";
            this.lbxStreet.Size = new System.Drawing.Size(645, 763);
            this.lbxStreet.TabIndex = 2;
            this.lbxStreet.SelectedIndexChanged += new System.EventHandler(this.lbxStreet_SelectedIndexChanged);
            // 
            // lblPref
            // 
            this.lblPref.AutoSize = true;
            this.lblPref.Font = new System.Drawing.Font("MS UI Gothic", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(128)));
            this.lblPref.Location = new System.Drawing.Point(51, 40);
            this.lblPref.Name = "lblPref";
            this.lblPref.Size = new System.Drawing.Size(47, 33);
            this.lblPref.TabIndex = 3;
            this.lblPref.Text = "Áúå";
            // 
            // lblCity
            // 
            this.lblCity.AutoSize = true;
            this.lblCity.Font = new System.Drawing.Font("MS UI Gothic", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(128)));
            this.lblCity.Location = new System.Drawing.Point(383, 40);
            this.lblCity.Name = "lblCity";
            this.lblCity.Size = new System.Drawing.Size(47, 33);
            this.lblCity.TabIndex = 4;
            this.lblCity.Text = "Â∏Ç";
            // 
            // lblStreet
            // 
            this.lblStreet.AutoSize = true;
            this.lblStreet.Font = new System.Drawing.Font("MS UI Gothic", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(128)));
            this.lblStreet.Location = new System.Drawing.Point(801, 40);
            this.lblStreet.Name = "lblStreet";
            this.lblStreet.Size = new System.Drawing.Size(47, 33);
            this.lblStreet.TabIndex = 5;
            this.lblStreet.Text = "Áî∫";
            // 
            // lblPostalCode
            // 
            this.lblPostalCode.AutoSize = true;
            this.lblPostalCode.Font = new System.Drawing.Font("MS UI Gothic", 15F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(128)));
            this.lblPostalCode.Location = new System.Drawing.Point(257, 824);
            this.lblPostalCode.Name = "lblPostalCode";
            this.lblPostalCode.Size = new System.Drawing.Size(0, 40);
            this.lblPostalCode.TabIndex = 6;
            // 
            // Form1
            // 
            this.AutoScaleDimensions = new System.Drawing.SizeF(13F, 24F);
            this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
            this.ClientSize = new System.Drawing.Size(1974, 929);
            this.Controls.Add(this.lblPostalCode);
            this.Controls.Add(this.lblStreet);
            this.Controls.Add(this.lblCity);
            this.Controls.Add(this.lblPref);
            this.Controls.Add(this.lbxStreet);
            this.Controls.Add(this.lbxCity);
            this.Controls.Add(this.lbxPref);
            this.Name = "Form1";
            this.Text = "ÈÉµ‰æøÁï™Âè∑Ê§úÁ¥¢";
            this.ResumeLayout(false);
            this.PerformLayout();

        }

        #endregion

        private System.Windows.Forms.ListBox lbxPref;
        private System.Windows.Forms.ListBox lbxCity;
        private System.Windows.Forms.ListBox lbxStreet;
        private System.Windows.Forms.Label lblPref;
        private System.Windows.Forms.Label lblCity;
        private System.Windows.Forms.Label lblStreet;
        private System.Windows.Forms.Label lblPostalCode;
    }



    internal static class Program
    {
        /// <summary>
        /// „Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„ÅÆ„É°„Ç§„É≥ „Ç®„É≥„Éà„É™ „Éù„Ç§„É≥„Éà„Åß„Åô„ÄÇ
        /// </summary>
        [STAThread]
        static void Main()
        {
            Application.EnableVisualStyles();
            Application.SetCompatibleTextRenderingDefault(false);
            Application.Run(new Form1());
        }
    }

}

```
„Éó„É≠„Ç∞„É©„É†Êú¨‰Ωì„Å®„Éá„Éº„Çø„ÇíÂà•„ÅÆ„Éï„Ç°„Ç§„É´„Å´„Åó„Å¶„ÅÑ„Çã„ÅÆ„ÅßÈÉµ‰æøÁï™Âè∑„Å´ËøΩÂä†Â§âÊõ¥„Åå„ÅÇ„Å£„ÅüÂ†¥Âêà„ÅØ„Ç®„ÇØ„Çª„É´„Éï„Ç°„Ç§„É´„Çí„Ç¢„ÉÉ„Éó„Éá„Éº„Éà„Åô„Çå„Å∞„Åù„ÅÆ„Åæ„Åæ‰Ωø„Åà„Åæ„Åô„ÄÇ
